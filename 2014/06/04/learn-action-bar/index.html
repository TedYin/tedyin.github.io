<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Learn ActionBar | TedYin&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="#ActionBar OverviewActionBar有如下几个特点:

ActionBar 是android系统提供专门用来应用导行功能的一个控件
提供一种非常便捷和高效的导航方式
支持不同页面间的导航功能切换

是android在3.0时添加的一个重要组件。它可以通过support library的形式被集成到2.1及其以上的版本中使用。">
<meta property="og:type" content="article">
<meta property="og:title" content="Learn ActionBar">
<meta property="og:url" content="http://www.tedyin.me/2014/06/04/learn-action-bar/index.html">
<meta property="og:site_name" content="TedYin's Blog">
<meta property="og:description" content="#ActionBar OverviewActionBar有如下几个特点:

ActionBar 是android系统提供专门用来应用导行功能的一个控件
提供一种非常便捷和高效的导航方式
支持不同页面间的导航功能切换

是android在3.0时添加的一个重要组件。它可以通过support library的形式被集成到2.1及其以上的版本中使用。">
<meta property="og:image" content="http://7xii1s.com1.z0.glb.clouddn.com/201406090916.png">
<meta property="og:updated_time" content="2016-02-29T09:35:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learn ActionBar">
<meta name="twitter:description" content="#ActionBar OverviewActionBar有如下几个特点:

ActionBar 是android系统提供专门用来应用导行功能的一个控件
提供一种非常便捷和高效的导航方式
支持不同页面间的导航功能切换

是android在3.0时添加的一个重要组件。它可以通过support library的形式被集成到2.1及其以上的版本中使用。">
<meta name="twitter:image" content="http://7xii1s.com1.z0.glb.clouddn.com/201406090916.png">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xii1s.com1.z0.glb.clouddn.com/me.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">TedYin</a></h1>
		</hgroup>

		
		<p class="header-subtitle">快乐比生命更重要</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/TedYin" title="github">github</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/TedYin" title="twitter">twitter</a>
					        
								<a class="mail" target="_blank" href="mailto:tedworld.time@gmail.com" title="mail">mail</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/android/" style="font-size: 20px;">android</a> <a href="/tags/elasticsearch/" style="font-size: 20px;">elasticsearch</a> <a href="/tags/gson/" style="font-size: 10px;">gson</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">Half full stack developer.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">TedYin</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xii1s.com1.z0.glb.clouddn.com/me.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">TedYin</h1>
			</hgroup>
			
			<p class="header-subtitle">快乐比生命更重要</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/TedYin" title="github">github</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/TedYin" title="twitter">twitter</a>
			        
						<a class="mail" target="_blank" href="mailto:tedworld.time@gmail.com" title="mail">mail</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-learn-action-bar" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/06/04/learn-action-bar/" class="article-date">
  	<time datetime="2014-06-03T16:00:00.000Z" itemprop="datePublished">2014-06-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Learn ActionBar
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#ActionBar Overview<br>ActionBar有如下几个特点:</p>
<ul>
<li>ActionBar 是android系统提供专门用来应用导行功能的一个控件</li>
<li>提供一种非常便捷和高效的导航方式</li>
<li>支持不同页面间的导航功能切换</li>
</ul>
<p>是android在3.0时添加的一个重要组件。它可以通过support library的形式被集成到2.1及其以上的版本中使用。<br><a id="more"></a></p>
<p>#ActionBar Use<br>下面主要介绍一下使用support v7 library中的ActionBar。</p>
<p>###Add ActionBar</p>
<ol>
<li>先<a href="http://developer.android.com/tools/support-library/setup.html" target="_blank" rel="external">导入v7包</a>.</li>
<li>你的Activity必须继承自ActionBarActivity</li>
<li>在你的应用中使用Theme.AppComapt主题或者使用继承自Theme.AppCompat主题的自定义。</li>
</ol>
<p><em>注：Theme.AppCompat 相当于3.0中添加的Theme.Holo主题</em><br>这样在你的Activity中就完成了ActionBar的添加。</p>
<p>###Removing the action bar<br>关闭ActionBar的方法如下:</p>
<ul>
<li>getSupportActionBar()得到ActionBar的对象，调用hide方法即可关闭ActionBar。如果想再次显示，则可以是用show方法即可</li>
<li>使用Them.AppCompat.NoActonBar方法，不使用Actionbar</li>
</ul>
<blockquote>
<p>注意</p>
<ul>
<li>support包中的getSupportXXX()方法就等同于在加入该控件的API level以上的SDK中调用 getXXX()方法。</li>
<li>在使用ActionBar的show()和hide()方法的时候，会导致界面布局调整，整个界面会被重绘，增加性能成本，如果需要经常对ActionBar进行隐藏和显示操作，我们可以使用ActionBar Overlay来完成这个需求。ActionBar Overlay的实现方式是使用Custom的主题继承自Theme.AppCompat并且设置windowActionBarOverlay这个属性为true即可。它会使得ActionBar浮在Layout的上面，此时如果对ActionBar进行show或者hide操作，就不会进行界面重绘了。如果你的布局不想被ActionBar挡住，则可以在该布局的根一级的Layout中加入paddingTop 或者marginTop属性，给他们赋值为”?android:attr/actionBarSize”即可。</li>
</ul>
</blockquote>
<p>###Add Action Items</p>
<p>上面已经有了ActionBar，但是如何让这个ActionBar进行工作呢?因此我们需要给ActionBar添加内容。ActionBar相当于一个导航容器，他是一个什么都能接收到东西。你可以自定义许多内容给他，他都可以将这些东西组织并展现出来。ActionBar跟3.0之前的版本中的菜单一样，提供一堆功能导航，只是在3.0之后将它的作用明确了，尤其是在4.0之后配合Android Design一起使得它的功能性更明确了就是处理Activity中的动作交互。添加Action Item我们只需在res/menu/xxx_menu.xml中定义好要添加的Item内容，然后重载OnCreateOptionsMenu()方法，并且在其中使用MenuInflater将这个xml布局inflate成Menu对象，并且设置给ActionBar即可。</p>
<pre><code>@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu items for use in the action bar
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.main_activity_actions, menu);
    return super.onCreateOptionsMenu(menu);
}
</code></pre><p>xxx_menu.xml布局文件如下：</p>
<pre><code>&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;
    &lt;item android:id=&quot;@+id/action_search&quot;
          android:icon=&quot;@drawable/ic_action_search&quot;
          android:title=&quot;@string/action_search&quot;/&gt;
    &lt;item android:id=&quot;@+id/action_compose&quot;
          android:icon=&quot;@drawable/ic_action_compose&quot;
          android:title=&quot;@string/action_compose&quot;
          yourStyle:showAsAction=&quot;ifRoome&quot;/&gt;
&lt;/menu&gt;
</code></pre><p><em>yourStyle:showAsAction</em>是需要用户自定义的属性，在3.0以上版本中属于Android的默认属性。<code>showAsAction</code>属性的选项有<code>ifRoom/always/never</code>,作用如下:</p>
<ul>
<li>ifRoom 表示如果有做够的空间，Action将会显示在ActionBar，否则会隐藏到overFlow中</li>
<li>always 表示永远显示在ActionBar上</li>
<li>never表示永不显示在ActionBar上，即永远显示在overflow中</li>
</ul>
<p>当用户点击上述按钮的时候会调用<code>onOptionsItemSelected(MenuItem item)</code>方法，并且将被点击的Item传入到Menu中去，因此我们可以重载该方法并且在该方法中处理按钮点击事件，和处理普通的点击事件一样。</p>
<blockquote>
<p>如果你是在Fragment中使用<code>OnCreateOptionsMenu</code>方法inflate一个Menu到ActionBar上，当你在Fragment中点击ActionBar中的Action时，如果你在<code>OnOptionsItemSelected</code>中使用了<code>super.onOptionsItemSelected</code>方法，系统会先调用Activity中的<code>OnOptionsItemSelected()</code>方法去处理，处理完成后才会调用Fragment中的这个方法处理，如果不加则会直接调用Fragment中的<code>OnOptionsItemSelected()</code>方法处理。</p>
</blockquote>
<p>###Using Split Action bar<br>Split ActionBar其实就是对ActionBar的分割，当用户使用窄屏幕的时候，如果在ActionBar上面不够放，系统会将Actions都放在屏幕的底部，来为导航和标题留出空间。使用Split Action Bar的效果图如下第1~2图。</p>
<p><img src="http://7xii1s.com1.z0.glb.clouddn.com/201406090916.png" alt="normal ActionBar"></p>
<p>使用Split action bar 的方法如下:</p>
<ul>
<li>给<code>&lt;application&gt;</code>标签添加属性 <code>uiOptions=&quot;splitActionBarWhenNarrow&quot;</code>,使得所有的Activity都应用Split Action Bar或者给某些指定的<code>&lt;activity&gt;</code>标签添加该属性，指定某几个Activity应用Split Action Bar。这个属性只能用于API level 14及其以上，如果想对其以下的版本进行兼容，需要在<code>&lt;activity&gt;</code>标签下使用<code>&lt;meta-data&gt;</code>标签来指定</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">...</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span><br><span class="line">        <span class="attr">android:name</span>=<span class="string">"android.support.UI_OPTIONS"</span></span><br><span class="line">        <span class="attr">android:value</span>=<span class="string">"splitActionBarWhenNarrow"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果Activity使用了该属性，并且对于ActionBar上的icon和title分别使用<code>setDisplayShowHomeEnable(false)</code>和<code>setDisplayShowTitleEnable(false)</code>进行隐藏，那那么在有tab的情况下，main ActionBar也会被自动隐藏，效果如上图中第2~3图。</p>
<p>###Navigating Up with the App Icon<br>Navigating Up返回到上一级Activity，有两种方法：</p>
<ol>
<li><p>在<code>&lt;activity&gt;</code>标签中设置<code>android:parentActivityName=&quot;me.tedyin.todo.MainActivity&quot;</code>（API level 16及其以上）即可，对于API level低于16的可以使用<code>&lt;meta-data&gt;</code>标签来指定</p>
<p> &lt;activity  …             android:parentActivityName=”com.example.app.MainActivity”</p>
<pre><code>&gt;
&lt;meta-data
    android:name=&quot;android:support.PARENT_ACTIVITY&quot;
    android:value=&quot;com.example.app.MainActivity&quot;
    /&gt;
</code></pre> <activity>

<blockquote>
<p><em>注意：上面<code>android:parentActivityName</code>的值必须和下面meta-data的value中定义的值相同。</em></p>
</blockquote>
</activity></li>
</ol>
<ol>
<li>在代码中使用<code>getSupportActionBar().setDisplayHomeAsUpEnable(true)</code>来开启navigate up 按钮。</li>
</ol>
<p>当Up Action 打开后，此时Icon前面会出现一个系统默认的返回按钮，表示可以返回到父Activity中。当点击该Up Action的时候，会调用<code>OnOptionsItemSelected(MenuItem)</code>方法，传入的是Id为<code>android.r.id.home</code>的<code>MenuItem</code>对象，我们可以重载上述方法来处理此点击事件。        </p>
<blockquote>
<p>如果我们的应用在关闭的情况下被第三方打开某个Activity，那么此时我们的activity则是在一个新的task stack中，此时该Activity的Logic Parent是不在该stack中的，为了保证操作的连贯性，你应该处理这种情况。我们可以使用NavUtils 来帮助我们处理，处理的过程如下:</p>
<ol>
<li>调用shouldUpReCreateTask(Context , Intent)来检查你的Activity是否存在一个App ‘s stack，包含你的Activity，如果返回true（不存在，需要重新创建），如果返回false（存在，不需要重新创建）。</li>
<li>如果需要重新创建，则需要使用TaskStackBuilder来方便我们创新的task stack 。</li>
</ol>
</blockquote>
<p>最佳实践如下:</p>
<pre><code>//重载OnOptionsItemSelected(MenuItem)方法
case android.R.id.home:
    Intent upIntent = NavUtils.getParentActivityIntent(this);
    if(NavUtils.shouldUpRecreateTask){
        //需要重新创建一个Task，来保存当前Activity的Parent Activity 到新的task stack中
        TaskStackBuilder.create(this).addNextIntentWithParentStack(upIntent).startActivitise();
    }else{
        //不需要的新建一个task来维护当前Activity和它的Parent Activity之间的stack关系，所以直接启动切换到父Activity即可
        NavUtils.navigateUpTo(this,upIntent);
    }
break;
</code></pre><blockquote>
<p>如果是从Fragment中处理Navigation Up,我们需要覆写onSupportNavigateUp()方法去处理fragment transaction。通常我们会用popBackStack()方法处理fragment切换到Parent Fragment中去。</p>
</blockquote>
<p>###Adding an Action View<br>Action View就是显示在ActionBar上面的Widget，他可以不需要改变Activity Fragment，并且也不会替换原有的ActionBar，不会导致界面重绘等问题，可以快速提供一个丰富的Action交互空间。我们常见的Search操作就是使用的ActionView来实现的。</p>
<p>####声明一个ActionView有如下方法:</p>
<ul>
<li>使用<code>actionLayout</code>属性来指定一个resource资源来生成一个ActionView</li>
<li>使用<code>actionViewClass</code>属性来指定一个Widget来生成一个ActionView</li>
</ul>
<p>添加一个ActionView的方法如下:(此处添加一个Widget来作为ActionView)</p>
<pre><code>&lt;menu ... &gt;
    &lt;item  android:id = &quot;@+id/action_search&quot;
        android:title=&quot;search&quot;
        andorid:icon=&quot;@drawable/icon&quot;
        yourStyle:showAsAction=&quot;ifRoom|collapseActionView&quot;
        yourStyle:actionViewClass=&quot;android.support.v7.widget.SearchView&quot;
        &gt;
&lt;/menu&gt;
</code></pre><p>上述中collapseActionView的作用即为当点击Action Button时触发ActionView。</p>
<p>上面声明了ActionView，我们可以在OnCreateOptionsMenu(Menu)方法中inflate出这个ActionView并将其加入到ActionBar中。</p>
<pre><code>@Overried
public void OnCreateOptionsMenu(Menu menu){
    getMenuInflater().inflate(R.layout.menu_actions,  menu);
    MenuItem searchItem = menu.findItem(R.id.action_search);
    SearchView searchView = (SearchView)MenuItemCompat.getActionView(searchItem);
    ...
    return super.OnCreateOptionsMenu(menu);
}
</code></pre><p>使用MenuItemCompat的静态方法getActionView(MenuItem)即可得到ActionView。<br><em>在API leve 11及其以上，<code>MenuItem</code>对象也提供<code>getActionView()</code>方法，即：<code>menu.findItem(R.id.action_search).getActionView()</code></em></p>
<p>###Handling collapsible action views<br>上面只讲述了如何打开Action view但是没有告诉你怎么collapse 一个 action view，下面就讨论一下如何collapse一个action view。当你点击返回键或者Up navigate button时，ActionView会自动收起。我们可以使用<code>OnActionExpandListener</code>来监听ActionView的打开与关闭。</p>
<pre><code>@Override
public void OnCreateOptionsMenu(Menu menu){
    MenuItemCompat.setOnActionExpandListener(menuItem, new OnActionExpandListener(){
        @Overried
        public boolean onMenuItemActionCollapse(MenuItem item){
            //do something
        }
        @Overried
        public boolean onMenuItemActionExpand(MenuItem item){
            //do something
        }
    });
}
</code></pre><p>###Add an Action Provider<br>每一个ActionProvider都已经定义好了自己的行为，因此你不需要再在OnOptionItemSelected()方法中对ActionProvider处理。虽然不用处理，但是如果你需要监听ActionProvider的行为的话，依然可以在OnOptionsItemSelected()方法中监听处理，但是一定要注意，然会值应该为false，否则ActionProvider无法收到点击事件。如果ActionProvider提供一个子菜单的话，那么子菜单中的点击事件不会调用OnOptionsItemSelected()方法。使用了ActionProvider我们需要处理的其实就是<br>ActionProvider使用方法如下:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
      xmlns:yourapp=&quot;http://schemas.android.com/apk/res-auto&quot; &gt;
    &lt;item android:id=&quot;@+id/action_share&quot;
          android:title=&quot;@string/share&quot;
          yourStyle:showAsAction=&quot;ifRoom&quot;
          yourStyle:actionProviderClass=&quot;android.support.v7.widget.ShareActionProvider&quot;
          /&gt;
    ...
&lt;/menu&gt;    
</code></pre><p>上述中<code>actionProviderClass</code>属性，在API Level 11以下需要自定义实现。添加完了布局文件，我们需要做的就是给在初始化ActionProvider的时候传入正确的Intent来保证他会按照我们设置的方式来工作。因为Context会变化，因此必须在每次更新的时候都要调用一次<code>setShareItent()</code>来保证我们Inent的正确。</p>
<pre><code>private ShareActionProvider shareActionProvider;
//...
@Overried
public boolean OnCreateOptionsMenu(Menu menu){
    getMenuInflater.inflate(R.id.menu,menu);
    //set up share action provider
    MenuItem shareItem = menu.findItem(R.id.action_share);
    shareActionProvider = (ShareActionProvider)MenuItemCompat.getActionProvider(shareItem);
    //set share intent
    Intent intent = new Intent(Intent.ACTION_SEND);
    intent.setType(&quot;image/*&quot;);
    shareActionProvider.setShareIntent(intent);
    return supper.OnCreateOptionsMenu(menu);
}
</code></pre><p><code>ShareActionProvider</code>默认会根据用户的使用频率动态的调整每个Item的先后顺序，这个排序是保存在一个私有的文件<code>DEFAULT_SHARE_HISTORY_FIILE_NAME</code>中，我们可以使用<code>ShareActionProvider</code>对象的<code>setShareHistoryFileName(&quot;example.xml&quot;)</code>方法来指定一个排序文件，按照我们喜欢的方式进行自定义排序。</p>
<p>###Creating a custom action provider<br>使用自定义的Action Provider可以很方便的让你去管理和重用那些Action动作，而不用你再去每个Activity或者Fragment中去处理Action的行为。<br>创建自定义Action Provider的步骤如下:</p>
<ol>
<li>继承ActionProvider这个类</li>
<li>实现ActionProvider()这个构造方法，他会传递一个Application Context 给你，你需要保存这个Context为后面其他回调方法提供。</li>
<li>实现<code>onCreateActionView(MenuItem menuItem)</code>方法，这个方法是用来inflate action view的。</li>
<li>实现<code>onPerformDefaultAction()</code>这个方法是在触发Action的时候系统调用的。这个方法默认是不实现任何操作，并且返回false</li>
</ol>
<p><em>注:如果你的ActionProvider是放在Overflow中的，而且它有subMenu，那么在点击时<code>onPerformDefaultAction()</code>这个方法是不会被调用的</em></p>
<p>###Adding  Navigation Tabs<br>Tabs 提供了方便的导航，他的添加方法如下:</p>
<ol>
<li>实现<code>ActionBar.TabListener</code>接口。这个接口提供了许多tab事件的回调方法，你可以在这个接口中处理和tab相关的操作。</li>
<li>对于每个你想添加的tab你在初始化这个tab的时候，可以通过<code>setTabListener()</code>方法添加<code>TabListener</code>，也可以同过<code>setTabTitle(title)</code>来设置tab的属性等。</li>
<li>当初始化好一个tab后可以使用<code>addTab(yourTab)</code>方法将它加入到ActionBar去。</li>
<li>必须调用<code>setNavigationMode(NAVIGATION_MODE_TABS)</code>方法让tab显示出来。</li>
</ol>
<blockquote>
<p>注意:</p>
<ol>
<li>ActionBar.TabListener的回调方法不会指定哪个fragment和具体的tab绑定，它只会提供当前选中了哪个tab，你需要自己根据需要绑定，下面介绍一种绑定实现.</li>
<li>初始化一个Tab的方法: Tab tab = actionBar.newTab().setText(“tab”).setTabListener(tabListener);   然后 actionBar.addTab(tab);即可。</li>
</ol>
</blockquote>
<pre><code>//TabListener的实现
public static class TabListener&lt;T extends Fragment&gt; implements ActionBar.TabListener{
    private Fragment mFragment;
    private final String mTag;//用来唯一标识Fragment在FragmentTransaction中的key
    private final Activity mActivity;//用来初始化Fragment
    private final Class&lt;T&gt; mClass;//Frangment的类，用来初始化fragment
    public TabListener(Activity activity, String keyTag, Class&lt;T&gt; clz){
        this.mTag = keyTag;
        this.mActivity = activity;
        this.mClass = clz;
    }
    public void onTabSelected(Tab tab, FragmentTransaction ft){
        // when tab selected
        //如果没有初始化，则进行初始化
        if(mFragment == null){
            mFragment = Fragment.instantiate(mActivity, mClass.getName());
            ft.add(android.R.id.content,mFragment,mTag);
        }else{
            //存在则直接attach显示
            ft.attach(mFragment);
        }
    }
    public void onTabUnSelected(Tab tab, FragmenTransaction ft){
        //whne tab unselected
        if(mFragment != null){
            //detach ，因为别的Fragment要attach显示
            ft.detach(mFragment);
        }
    }
    public void onTabReselected(Tab tab. FragmentTransaction ft){
        //user select the already selected tab , Usually do nothing. 因为他就是当前显示的，所以不需要操作什么。
    }
}
</code></pre><blockquote>
<p><strong>注意：在回调中我们禁止调用commit()方法来确认fragment transaction，因为系统会为我们调用它，如果我们自己调用的话会出现异常。你同样也不能将这个fragment transaction 加入到back task stack中！</strong></p>
<p><em>上面的<code>android.R.id.content</code>是root view的Id，在不使用<code>setContentView</code>时使用它来作为Fragment的容器</em></p>
</blockquote>
<p>下面的代码使用了上面的TabListener，示例如下:</p>
<pre><code>@Overried
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    //use the android.R.id.content as the container for each fragment , it is the root view id. 因此不用setContentView()
    //setup action bar for tabs
    ActionBar actionBar = getSupportActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);//显示tabs
    actionBar.setDisplayShowTitleEnable(false);
    Tab tab1 = actionBar.newTab().setText(&quot;tab1&quot;).setTabListener(new TabListener&lt;Fragment&gt;(this,&quot;tab1&quot;,MFirstFragment.class));
    actionBar.addTab(tab);
    Tab tab2 = actionBar.newTab().setText(&quot;tab2&quot;).setTabListener(new TabListener&lt;Fragment&gt;(thsi,&quot;tab2&quot;,MSecondFragment.class));
    actionBar.addTab(tab2);
}
</code></pre><p><em>未完待续~~</em></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/06/22/OOM/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          OOM 的解决方法
        
      </div>
    </a>
  
  
    <a href="/2014/06/03/SQLite-study/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">SQLite Study</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="learn-action-bar" data-title="Learn ActionBar" data-url="http://www.tedyin.me/2014/06/04/learn-action-bar/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 TedYin
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>